#!/usr/bin/env sh
set -e

command -v curl >/dev/null 2>&1 || {
  echo "curl is required but not installed."
  exit 1
}

TARGET="$HOME/.local/bin/cleandl"

if [ -f "$TARGET" ]; then
  echo "cleandl already exists at $TARGET"
  echo "Aborting to avoid overwrite."
  exit 1
fi

mkdir -p "$HOME/.local/bin"

curl -fsSL \
  https://raw.githubusercontent.com/uberblatt/cleandl/main/cleandl \
  -o "$TARGET"

head -n 1 "$TARGET" | grep -q "^#!" || {
  echo "Downloaded file does not look like a script."
  rm -f "$TARGET"
  exit 1
}

chmod +x "$TARGET"

echo "cleandl installed successfully ðŸŽ‰"

if ! echo "$PATH" | grep -q "$HOME/.local/bin"; then
  echo "Note: ~/.local/bin is not in your PATH."
fi

echo "Run: cleandl"
